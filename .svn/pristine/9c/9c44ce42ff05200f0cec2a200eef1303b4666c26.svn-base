import { FontAwesomeIcon } from '@fortawesome/react-fontawesome';
import {faCheck} from "@fortawesome/free-solid-svg-icons"
import { useEffect } from 'react';
import EditModal from '../common/EditModal';
import AllotTable from './AllotTable';
import {toast,ToastContainer} from "react-toastify"
import { useContext, useState } from "react";
import { RequestsListContext } from "./RequestsContext";
import axios from 'axios';

function RequestsRow(props){
    const {requestsList, updateReq} = useContext(RequestsListContext)
    const location = props.ambulance.location.lat+", "+props.ambulance.location.lng
    const [disabled,setDisabled]=useState(false)
    const RejectHandler=async()=>{
        try{
         updateReq(props.id)   
        await axios.patch(`http://localhost:5000/api/request/${props.id}`,{status:"Rejected"}).then(()=>{
     
        toast.success("Denied Successful !", {
                position: toast.POSITION.BOTTOM_RIGHT,
              });
              
        })
        }
        catch(err){

        }
     }
     const ApproveHandler=async()=>{
        try{
         updateReq(props.id)   
         props.openHandler(props)
       
        }
        catch(err){

        }
     }
     if(props.status=="Pending"){
    return(
        <>
        <div className={`flex w-full h-12 px-5 items-center border-b-2 bg-white py-1`}>
           
            <div className="w-[10%]">
                {props.index}
            </div>
            <div className="w-[20%]">
                {props.ambulance.name}
            </div>
            <div className="w-[20%]">
                {location}
            </div>
            <div className="w-[20%]">
                {props.ambulance.emergency.details}
            </div>
            <div className="w-[30%] flex justify-between px-10">
                <div className='border-2 rounded-md text-sm text-white bg-blue-400 cursor-pointer px-3 py-1 font-semibold' onClick={ApproveHandler}>Accept</div>
                <div className='border-2 rounded-md text-sm text-white bg-red-400 cursor-pointer px-3 py-1 font-semibold' onClick={RejectHandler}>Decline</div>
            </div>
        </div>
        <ToastContainer></ToastContainer>
       
        </>
     
    )}
}
export default RequestsRow